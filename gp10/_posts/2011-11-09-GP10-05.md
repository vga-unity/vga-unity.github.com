---
layout: post
title: GP10 ミドルウェア 05
---

## 今週のサンプルプログラム

### yamada

[https://github.com/vga-unity/yamada](https://github.com/vga-unity/yamada)

加速度センサーを使った滑らかな操作系の実装例。

### ポイント

操作系のキモとなるのは Yama スクリプト。

[https://github.com/vga-unity/yamada/blob/master/Assets/Scripts/Yama.js](https://github.com/vga-unity/yamada/blob/master/Assets/Scripts/Yama.js)

滑らかな操作性を実現するために、ちょっと複雑な処理を行っている。大まかに解説すると、次のような流れになる。

 - **加速度値を `inputTrim` でクランプ** - これにより、浅めの傾きでリミットすることができる。感度を良くするための工夫。
 - **傾き量をターゲットとして速度をイーズアウト** - これにより、速度の変化を緩やかにしている。`Sensibility` を上げれば応答性は良くなるが、動きが極端になってしまう可能性がある。なお、画面端に達した場合は傾きを無視して 0 をターゲットとする。
 - **速度に応じて移動**
 - **速度に応じて回転**
 
イーズアウトとはなだらかな減速によって動きを止める処理のこと。このスクリプトでは指数関数を使ったフレームレート非依存の特殊なイーズアウト関数を実装している。この関数について詳しくは[こちらを参照](http://radiumsoftware.tumblr.com/post/5031889912)。ただまあ、コピペで使っても問題ない。

### 加速度を使った方向操作系を実装する際のコツ

歴史の浅い分野なので、ぶっちゃけあまりノウハウは無い。ただ一般論として以下のようなことが言える。

 - **「滑らかさ」と「応答の良さ」の微妙なバランスを意識する。**複数の補間式を使って動きを滑らかにする必要があるが、あまりやり過ぎると応答性が悪くなる。ここは大いに調整のしがいがあるところ。
 - **繊細な操作を楽しむ内容を意識する。**反射神経を試すような内容のゲームではボタン操作に勝つことができない。逆に、針の穴を通すような繊細さを求めるゲーム内容では、傾き操作系は意外な楽しさを発揮する。
 - **視覚的なフィードバックが操作感を生み出すことを意識する。**たとえばこの yamada でも、自機の回転を無くすと途端に操作性が悪くなる。動きのパラメーター調整だけでなく、見た目も操作系の一部なのだと意識すると良い。
